<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.w3.org/1999/xhtml"
      layout:decorate="~{master.html}" lang="en">
<head>
    <meta charset="utf-8">
    <title>[[${movie.title}]]</title>
</head>
<body>

<div layout:fragment="content" th:object="${movie}">
    <div th:if="${msg != null}" class='alert alert-success' th:text="${msg}" role='alert'></div>
    <div th:if="${msga != null}" class='alert alert-danger' th:text="${msga}" role='alert'></div>
    <div class="row">
        <div class="col-md-6">
            <a href="javascript:history.back()">
                <img th:src="@{'/images/uploads/'+ ${movie.image}}" th:alt="*{title}" class="img-fluid rounded w-10">
            </a>

        </div>
        <div class="col-md-6">
            <div class="text-end my-3">
                <a th:href="@{/reviews/guardar/{id} (id=*{nid})}" class="btn btn-success">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-text" viewBox="0 0 16 16">
                        <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2z"/>
                        <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
                    </svg>
                    Crítica</a>
                <a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{/budget/guardar/{id} (id=*{nid})}" class="btn btn-success">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-cash-coin" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                              d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8m5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0"/>
                        <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195z"/>
                        <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083q.088-.517.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1z"/>
                        <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 6 6 0 0 1 3.13-1.567"/>
                    </svg>
                    Añadir Presup.</a>
                <a
                        th:href="@{https://www.youtube.com/watch?v={youtubeId}(youtubeId=*{youtubeTrailerId})}"
                        class="btn btn-danger" data-fancybox="">
                    <svg
                            xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                            fill="currentColor" class="bi bi-film" viewBox="0 0 16 16">
                        <path
                                d="M0 1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V1zm4 0v6h8V1H4zm8 8H4v6h8V9zM1 1v2h2V1H1zm2 3H1v2h2V4zM1 7v2h2V7H1zm2 3H1v2h2v-2zm-2 3v2h2v-2H1zM15 1h-2v2h2V1zm-2 3v2h2V4h-2zm2 3h-2v2h2V7zm-2 3v2h2v-2h-2zm2 3h-2v2h2v-2z"/>
                    </svg>
                    Ver trailer
                </a>
            </div>
            <h2 th:text="*{title}"></h2>
            <table class="table table-borderless">
                <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">Año:</th>
                    <td class="text-start" th:text="*{year}"></td>
                </tr>
                <tr>
                    <th scope="row">Duración:</th>
                    <td class="text-start" th:text="*{duration + ' min'}"></td>
                </tr>
                <tr>
                    <th scope="row">País:</th>
                    <td class="text-start" th:text="*{country}"></td>
                </tr>
                <tr>
                    <th scope="row">Géneros:</th>
                    <td><span class="badge rounded-pull bg-light text-dark me-1"
                              th:each="genero : *{genres}" th:text="${genero.description}"></span></td>
                </tr>
                <tr>
                    <th scope="row">Reparto:</th>
                    <td>
							<span class="badge rounded-pull bg-light text-dark me-1" th:each="actor : *{actors}">
								<a th:href="@{/actors/actor/} + ${actor.nid}" th:text="${actor.name}"></a>
							</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row">Sinopsis:</th>
                    <td class="text-start" th:text="*{synopsis}"></td>
                </tr>
                <tr>
                    <th scope="row" style="white-space: nowrap" !important;>Nota Media:</th>
                    <td class="text-start"
                        th:text="${#numbers.formatDecimal(notemedia, 1, 'DEFAULT', 2, 'POINT')}"></td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>

    <table class="table table-borderless table-hover">
        <thead>
        <tr>
            <th scope="col"></th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th scope="row">Críticas:</th>
            <td class="text-start"></td>
        </tr>
        <tr th:each="pos : ${criticas}">
            <th scope="row"></th>
            <td class="text-start fst-italic" th:text="${pos.assessment}"></td>
            <td class="text-end fst-italic">
                <a th:href="@{/reviews/{id} (id=${pos.id})}"
                   th:text="${'Autor: '+pos.user.username +' (puntuación: '+pos.note+') ' +pos.date}">
                </a>
            </td>
        </tr>
        </tbody>
    </table>
    <a class="btn btn-primary" role="button" th:href="@{/budget/{id} (id=${movie.nid})}">Ver Presupuesto</a>
</div>


</body>
</html>